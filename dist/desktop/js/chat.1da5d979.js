(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chat"],{4547:function(e,t,s){},"674c":function(e,t,s){},"99e4":function(e,t,s){"use strict";var n=s("674c"),i=s.n(n);i.a},a9e3:function(e,t,s){"use strict";var n=s("83ab"),i=s("da84"),r=s("94ca"),a=s("6eeb"),o=s("5135"),c=s("c6b6"),l=s("7156"),d=s("c04e"),u=s("d039"),h=s("7c73"),f=s("241c").f,p=s("06cf").f,v=s("9bf2").f,g=s("58a8").trim,m="Number",b=i[m],y=b.prototype,k=c(h(y))==m,x=function(e){var t,s,n,i,r,a,o,c,l=d(e,!1);if("string"==typeof l&&l.length>2)if(l=g(l),t=l.charCodeAt(0),43===t||45===t){if(s=l.charCodeAt(2),88===s||120===s)return NaN}else if(48===t){switch(l.charCodeAt(1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+l}for(r=l.slice(2),a=r.length,o=0;o<a;o++)if(c=r.charCodeAt(o),c<48||c>i)return NaN;return parseInt(r,n)}return+l};if(r(m,!b(" 0o1")||!b("0b1")||b("+0x1"))){for(var w,C=function(e){var t=arguments.length<1?0:e,s=this;return s instanceof C&&(k?u((function(){y.valueOf.call(s)})):c(s)!=m)?l(new b(x(t)),s,C):x(t)},O=n?f(b):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),j=0;O.length>j;j++)o(b,w=O[j])&&!o(C,w)&&v(C,w,p(b,w));C.prototype=y,y.constructor=C,a(i,m,C)}},ba22:function(e,t,s){},bc53:function(e,t,s){"use strict";var n=s("4547"),i=s.n(n);i.a},d460:function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"theme-dark",attrs:{id:"app"}},[s("title-bar"),e.websocket.socket.isConnected?e.isMinecraftLinked?s("div",{staticClass:"flex flex-row h-full"},[s("friends-list",{attrs:{showPage:e.showPage,hidePage:e.hidePage,currentPage:e.currentPage,messages:e.messages,friends:e.friends,activeFriend:null!==e.friend?e.friend.profile.chat.hash.medium:void 0,getFriends:e.getFriends,loading:e.loadingFriends}}),s("div",{staticClass:"bg-navbar flex-1"},["addFriend"===e.currentPage?s("AddFriend"):e._e(),"chatFriend"===e.currentPage&&null!==e.friend?s("FriendChat",{key:e.friend.profile.chat.hash.medium,attrs:{friend:e.friend,removeFriend:e.removeFriend,blockFriend:e.blockFriend,shortHash:e.friend.profile.chat.hash.medium,messages:e.messages[e.friend.profile.chat.hash.medium],sendMessage:e.sendMessage}}):e._e()],1)],1):e.auth.loggingIn?s("div",{staticClass:"flex flex-col h-full justify-center"},[s("font-awesome-icon",{staticClass:"mx-auto",staticStyle:{"font-size":"25vw"},attrs:{icon:"sync-alt",spin:""}})],1):s("div",{staticClass:"flex flex-col h-full justify-center"},[s("font-awesome-icon",{staticClass:"mx-auto",staticStyle:{"font-size":"25vw"},attrs:{icon:"user"}}),s("h2",{staticClass:"text-center"},[e._v("In order to use this feature, you must complete your account setup")]),s("ftb-button",{staticClass:"mx-auto py-2 px-4 my-2",attrs:{color:"primary"},on:{click:e.openProfile}},[e._v("Click here to continue")])],1):s("div",{staticClass:"flex flex-col h-full justify-center"},[s("font-awesome-icon",{staticClass:"mx-auto",staticStyle:{"font-size":"25vw"},attrs:{icon:"sync-alt",spin:""}})],1)],1)},i=[],r=(s("7db0"),s("c975"),s("d81d"),s("96cf"),s("1da1")),a=s("d4ec"),o=s("bee2"),c=s("262e"),l=s("2caf"),d=s("9ab4"),u=s("1e1d"),h=s("ffa8"),f=s("60a3"),p=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex flex-col h-full bg-background",staticStyle:{width:"300px"}},[s("div",{staticClass:"profile bg-navbar flex flex-row items-center relative",staticStyle:{height:"92px"}},[s("div",{staticClass:"minimtg pointer-events-none"}),s("div",{staticClass:"p-4 flex flex-row items-center"},[s("img",{staticClass:"rounded-full",staticStyle:{"margin-right":"0.75em"},attrs:{src:"https://api.mymcuu.id/head/"+e.avatarName,width:"30px"}}),s("div",{staticClass:"flex flex-col"},[null!==e.auth.token?s("p",{staticClass:"text-lg"},[e._v(e._s(e.auth.token.mc.display))]):e._e(),null!==e.auth.token?s("p",{key:"friendCode",staticClass:"text-xs cursor-pointer",on:{click:e.copyFriendCode}},[e._v(e._s(e.auth.token.mc.friendCode)+" "),s("transition",{attrs:{name:"fade"}},[e.copied?s("span",{key:"copied"},[e._v(" - Copied!")]):e._e()])],1):e._e()])])]),s("div",{staticClass:"friends flex flex-col overflow-hidden",staticStyle:{"max-height":"300px"}},[s("div",{staticClass:"bg-background-lighten p-2 flex flex-row"},[s("p",{staticClass:"ml-2"},[e._v("Friends")]),e.showSearch?s("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],staticClass:"bg-input text-xs mx-2",staticStyle:{padding:"0 2px"},attrs:{type:"search",placeholder:"Search..."},domProps:{value:e.search},on:{input:function(t){t.target.composing||(e.search=t.target.value)}}}):e._e(),s("div",{staticClass:"icons ml-auto"},[s("font-awesome-icon",{staticClass:"mx-2 cursor-pointer",attrs:{icon:"search"},on:{click:e.toggleSearch}}),s("font-awesome-icon",{staticClass:"mx-2 cursor-pointer",attrs:{icon:"user-plus"},on:{click:e.openAddFriendUI}})],1)]),s("div",{staticClass:"overflow-y-auto"},e._l(e.currentFriends,(function(t){return s("div",{key:t.id,class:"flex flex-row p-2 items-center "+("chatFriend"===e.currentPage&&void 0!==e.activeFriend&&e.activeFriend===t.shortHash?"bg-background-lighten":"hover:bg-background-lighten")+" cursor-pointer",on:{click:function(s){return e.openFriendChat(t)}}},[s("p",{class:"ml-2 cursor-pointer overflow-hidden "+(t.online?"text-white font-bold":"text-muted font-normal"),staticStyle:{"text-overflow":"ellipsis"}},[e._v(e._s(t.profile.display)+" ")]),e.unreadMessages[t.profile.chat.hash.medium]>0?s("p",{staticClass:"bg-red-600 rounded-full px-2 ml-2 text-xs"},[e._v(e._s(e.unreadMessages[t.profile.chat.hash.medium]))]):e._e(),s("div",{staticClass:"icons ml-auto"},[t.currentPack&&t.currentPack.length>0?s("font-awesome-icon",{staticClass:"mx-2 cursor-pointer",attrs:{icon:"gamepad",title:t.currentPack},on:{click:function(s){return e.openModpack(t)}}}):e._e(),t.online?s("font-awesome-icon",{staticClass:"mx-2 cursor-pointer",attrs:{icon:"comments"}}):e._e()],1)])})),0),0===e.currentFriends.length&&e.search.length>0?s("div",{staticClass:"flex flex-col items-center mt-4 text-sm"},[s("font-awesome-icon",{attrs:{icon:"sad-tear",size:"lg"}}),s("p",{staticClass:"p-2 text-center"},[e._v("No results")])],1):0===e.currentFriends.length&&e.loading?s("div",{staticClass:"flex flex-col items-center mt-4 text-sm"},[s("font-awesome-icon",{attrs:{icon:"sync-alt",spin:"",size:"lg"}}),s("p",{staticClass:"p-2 text-center"},[e._v("Loading friends")])],1):0===e.currentFriends.length&&0===e.search.length?s("div",{staticClass:"flex flex-col items-center mt-4 text-sm"},[s("font-awesome-icon",{attrs:{icon:"sad-tear",size:"lg"}}),s("p",{staticClass:"p-2 text-center"},[e._v("It looks like you don't have any friends added at the moment!")])],1):e._e()]),s("div",{staticClass:"friends flex flex-col overflow-y-auto"},[s("div",{staticClass:"bg-background-lighten p-2 flex flex-row mt-10 cursor-pointer",on:{click:e.toggleRequests}},[s("p",{staticClass:"ml-2 cursor-pointer"},[e._v("Pending Requests")]),e.friendRequests.length>0&&!e.showRequests?s("p",{staticClass:"bg-red-600 rounded-full px-2 ml-2 text-xs"},[e._v(e._s(e.friendRequests.length))]):e._e(),s("div",{staticClass:"icons ml-auto"},[s("font-awesome-icon",{staticClass:"mx-2 cursor-pointer",attrs:{icon:e.showRequests?"chevron-down":"chevron-left"}})],1)]),e.showRequests?s("div",e._l(e.friendRequests,(function(t){return s("div",{key:t.id,staticClass:"flex flex-row p-2 items-center hover:bg-background-lighten cursor-pointer"},[s("p",{staticClass:"ml-2"},[e._v(e._s(t.profile.display))]),-1===e.acceptingFriends.indexOf(t.hash)?s("div",{staticClass:"icons ml-auto"},[s("font-awesome-icon",{staticClass:"mx-2 cursor-pointer text-white hover:text-red-500",attrs:{icon:"times"}}),s("font-awesome-icon",{staticClass:"mx-2 cursor-pointer text-white hover:text-green-500",attrs:{icon:"check"},on:{click:function(s){return e.acceptFriendRequest(t.hash,t.profile.display,t.profile.friendCode)}}})],1):-1!==e.acceptingFriends.indexOf(t.hash)?s("div",[s("font-awesome-icon",{staticClass:"mx-2",attrs:{icon:"sync-alt",spin:""}})],1):e._e()])})),0):e._e()])])},v=[],g=(s("4de4"),s("4160"),s("a9e3"),s("b64b"),s("d3b7"),s("ac1f"),s("841c"),s("159b"),s("4bb5")),m=function(e){Object(c["a"])(s,e);var t=Object(l["a"])(s);function s(){var e;return Object(a["a"])(this,s),e=t.apply(this,arguments),e.copied=!1,e.showSearch=!1,e.showRequests=!0,e.search="",e.acceptingFriends=[],e}return Object(o["a"])(s,[{key:"toggleSearch",value:function(){this.showSearch=!this.showSearch}},{key:"toggleRequests",value:function(){this.showRequests=!this.showRequests}},{key:"onAuthChange",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,s){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:(null!==t.token&&void 0===t.token.mc.friendCode||JSON.stringify(t.token)!==JSON.stringify(s.token))&&this.getFriendCode();case 1:case"end":return e.stop()}}),e,this)})));function t(t,s){return e.apply(this,arguments)}return t}()},{key:"openFriendChat",value:function(e){this.showPage("chatFriend",e),this.$forceUpdate()}},{key:"openAddFriendUI",value:function(){"addFriend"===this.currentPage?this.hidePage():this.showPage("addFriend")}},{key:"acceptFriendRequest",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,s,n){var i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.acceptingFriends.push(t),void 0!==n){e.next=5;break}return e.next=4,this.getFriendCodeFromHash(t);case 4:n=e.sent;case 5:r=this,this.sendMessage({payload:{type:"addFriend",userHash:null===(i=r.auth.token)||void 0===i?void 0:i.mc.display,target:t},callback:function(){r.getFriends()}});case 7:case"end":return e.stop()}}),e,this)})));function t(t,s,n){return e.apply(this,arguments)}return t}()},{key:"getFriendCodeFromHash",value:function(e){return fetch("https://api.creeper.host/minetogether/friendcode",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({hash:e})}).then((function(e){return e.json()})).then(function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t.code);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){throw e}))}},{key:"openModpack",value:function(e){overwolf.utils.openUrlInDefaultBrowser("ftb://modpack/".concat(e.currentPackID))}},{key:"mounted",value:function(){this.showRequests=this.friendRequests.length>0}},{key:"copyFriendCode",value:function(){var e=this;this.auth.token&&(overwolf.utils.placeOnClipboard(this.auth.token.mc.friendCode),this.copied=!0,setTimeout((function(){return e.copied=!1}),2e3))}},{key:"avatarName",get:function(){var e,t=null===(e=this.auth.token)||void 0===e?void 0:e.accounts.find((function(e){return"mcauth"===e.identityProvider}));return void 0!==t&&null!==t?t.userId:"MHF_Steve"}},{key:"unreadMessages",get:function(){var e=this,t={};return Object.keys(this.messages).forEach((function(s){t[s]=e.messages[s].filter((function(e){return!e.read})).length})),t}},{key:"currentFriends",get:function(){var e=this,t=this.friends.friends.filter((function(e){return e.accepted})).sort((function(e,t){return Number(t.online)-Number(e.online)}));return this.search.length>0&&(t=t.filter((function(t){return-1!==t.profile.display.indexOf(e.search)}))),t}},{key:"friendRequests",get:function(){var e=this;return this.friends.requests.filter((function(t){return void 0===e.currentFriends.find((function(e){return e.id===t.id}))}))}}]),s}(f["c"]);Object(d["a"])([Object(g["c"])("auth")],m.prototype,"auth",void 0),Object(d["a"])([Object(g["a"])("getFriendCode",{namespace:"auth"})],m.prototype,"getFriendCode",void 0),Object(d["a"])([Object(g["a"])("sendMessage")],m.prototype,"sendMessage",void 0),Object(d["a"])([Object(f["b"])()],m.prototype,"loading",void 0),Object(d["a"])([Object(f["b"])()],m.prototype,"friends",void 0),Object(d["a"])([Object(f["b"])()],m.prototype,"currentPage",void 0),Object(d["a"])([Object(f["b"])()],m.prototype,"messages",void 0),Object(d["a"])([Object(f["b"])()],m.prototype,"hidePage",void 0),Object(d["a"])([Object(f["b"])()],m.prototype,"showPage",void 0),Object(d["a"])([Object(f["b"])()],m.prototype,"getFriends",void 0),Object(d["a"])([Object(f["d"])("auth",{deep:!0})],m.prototype,"onAuthChange",null),m=Object(d["a"])([Object(f["a"])({props:["showPage","hidePage","currentPage","messages","friends","activeFriend","loading"]})],m);var b=m,y=b,k=(s("f205"),s("2877")),x=Object(k["a"])(y,p,v,!1,null,null,null),w=x.exports,C=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex flex-col h-full w-full p-2"},[s("h1",{staticClass:"text-4xl "},[e._v("Add Friend")]),s("div",{staticClass:" "},[e.message.length>0?s("div",{class:"p-4 bg-"+e.messageType+" text-white mt-2 rounded"},[e._v(" "+e._s(e.message)+" ")]):e._e(),s("ftb-input",{attrs:{label:"Friend Code",value:e.friendCode},model:{value:e.friendCode,callback:function(t){e.friendCode=t},expression:"friendCode"}}),s("ftb-button",{staticClass:"text-center px-2 py-1",attrs:{color:"primary",disabled:e.auth.loading},on:{click:e.submit}},[e._v("Add")])],1)])},O=[],j=s("c7bf"),F=function(e){Object(c["a"])(s,e);var t=Object(l["a"])(s);function s(){var e;return Object(a["a"])(this,s),e=t.apply(this,arguments),e.message="",e.messageType="primary",e.friendCode="",e}return Object(o["a"])(s,[{key:"submit",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.message="",0!==this.friendCode.length){e.next=3;break}return e.abrupt("return");case 3:if(this.friendCode!==(null===(t=this.auth.token)||void 0===t?void 0:t.mc.friendCode)){e.next=7;break}return this.messageType="danger",this.message="You cannot add yourself as a friend!",e.abrupt("return");case 7:return e.next=9,this.submitFriendRequest({friendCode:this.friendCode});case 9:s=e.sent,"success"===s.status?(this.message="Friend Request Sent",this.messageType="primary",this.friendCode="",s.hash):(this.messageType="danger",this.message=s.message);case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),s}(f["c"]);Object(d["a"])([Object(g["c"])("auth")],F.prototype,"auth",void 0),Object(d["a"])([Object(g["a"])("submitFriendRequest",{namespace:"auth"})],F.prototype,"submitFriendRequest",void 0),F=Object(d["a"])([Object(f["a"])({components:{"ftb-input":j["a"],"ftb-button":h["a"]}})],F);var _=F,M=_,P=Object(k["a"])(M,C,O,!1,null,null,null),S=P.exports,R=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex flex-col h-full w-full p-2"},[s("div",{staticClass:"flex flex-row items-center"},[s("h1",{staticClass:"text-2xl max-w-xs overflow-hidden",staticStyle:{"text-overflow":"ellipsis"}},[e._v(e._s(e.friend.profile.display))]),s("div",{staticClass:"ml-auto mr-2 mt-6"},[s("font-awesome-icon",{staticClass:"mx-2 cursor-pointer text-muted hover:text-white",attrs:{icon:"ban",title:"Block"},on:{click:e.blockFriend}}),s("font-awesome-icon",{staticClass:"mx-2 cursor-pointer text-muted hover:text-white",attrs:{icon:"trash",title:"Remove"},on:{click:e.removeFriend}}),e.friend.currentServer?s("font-awesome-icon",{staticClass:"mx-2 cursor-pointer text-muted hover:text-white",attrs:{icon:"globe"},on:{click:e.openServer}}):e._e()],1)]),s("div",{ref:"chat",staticClass:"chat-area flex-1 overflow-y-scroll overflow-x-hidden mb-2",on:{scroll:e.onScroll}},e._l(e.sortedMessages,(function(t){return s("div",{key:JSON.stringify(t),staticClass:"flex flex-row"},[s("div",{class:(t.author===e.shortHash?"ml-auto mr-2 text-right":"ml-2 text-left")+" my-2 flex flex-col"},[s("p",{staticClass:" p-3 bg-input rounded text-left",domProps:{innerHTML:e._s(e.linkify(t.content))},on:{click:e.onMessageClick}}),s("small",{class:(t.author===e.shortHash?"ml-auto text-right ":"")+" text-muted text-xs"},[e._v(e._s(e._f("momentFromNow")(t.date/1e3)))])])])})),0),s("div",{staticClass:"flex flex-col items-stretch"},[e.friend.online?e._e():s("small",{staticClass:"text-xs text-center"},[e._v(e._s(e.friend.profile.display)+" is currently offline")]),s("div",{staticClass:"w-full flex flex-row items-center relative"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.newMessage,expression:"newMessage"}],class:"bg-background focus:outline-none border block flex-1 text-2xl transition-all duration-200 ease-in-out p-2 rounded appearance-none leading-normal text-gray-300 border-background-lighten shadow",attrs:{disabled:!e.friend.online},domProps:{value:e.newMessage},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.send(t)},input:function(t){t.target.composing||(e.newMessage=t.target.value)}}}),s("div",{staticClass:"bg-background-lighten p-4 h-full"},[s("font-awesome-icon",{attrs:{icon:"paper-plane"}})],1)])]),null!==e.checkLink?s("FTBModal",{attrs:{visible:null!==e.checkLink},on:{"dismiss-modal":e.hideModal}},[s("ConfirmationModal",{attrs:{title:"Are you sure you want to open this link?",message:"You're about to go to "+e.checkLink+", we do not control contents of this link and cannot be held responsible for anything caused by it. Please ensure you trust this link before continuing. Are you sure you wish to continue?",yesAction:e.navigateToLink,noAction:e.hideModal}})],1):e._e()],1)},I=[],A=(s("466d"),s("5319"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex flex-col min-w-1/2"},[s("h1",{staticClass:"text-2xl mb-2"},[e._v(e._s(e.title))]),s("div",[s("p",{staticClass:"text-center"},[e._v(e._s(e.message))])]),s("hr",{staticClass:"mt-4 mb-2"}),s("div",{staticClass:"flex justify-center"},[s("ftb-button",{staticClass:"py-2 px-4 mx-2 text-center float-right",attrs:{color:"danger","css-class":"text-center text-l"},on:{click:e.noAction}},[e._v("No")]),s("ftb-button",{staticClass:"py-2 px-4 mx-2 text-center float-right",attrs:{color:"primary","css-class":"text-center text-l"},on:{click:e.yesAction}},[e._v("Yes")])],1)])}),N=[],T=function(e){Object(c["a"])(s,e);var t=Object(l["a"])(s);function s(){return Object(a["a"])(this,s),t.apply(this,arguments)}return s}(f["c"]);T=Object(d["a"])([Object(f["a"])({name:"ConfirmationModal",props:["title","message","yesAction","noAction"],components:{"ftb-button":h["a"]}})],T);var q=T,L=q,E=Object(k["a"])(L,A,N,!1,null,null,null),H=E.exports,U=s("81d4"),D=function(e){Object(c["a"])(s,e);var t=Object(l["a"])(s);function s(){var e;return Object(a["a"])(this,s),e=t.apply(this,arguments),e.newMessage="",e.whitelistedDomains=["creeperhost.net","feed-the-beast.com","minetogether.io","creeper.host","playat.ch","ch.tools"],e.checkLink=null,e.lastScroll=0,e.hasScrolled=!1,e}return Object(o["a"])(s,[{key:"hideModal",value:function(){this.checkLink=null}},{key:"linkify",value:function(e){var t=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi;return e.replace(t,(function(e){return'<a href="'+e+'" target="_blank">'+e+"</a>"}))}},{key:"scrollToLastChild",value:function(){var e=this.$refs.chat,t=e.lastChild;null!==t&&t.scrollIntoView({behavior:"smooth"})}},{key:"onMessageClick",value:function(e){if(null!=e.target&&"A"===e.target.tagName){var t=e.target.href,s=t.match(/^(?:https?:\/\/)?(?:[^@\/\n]+@)?(?:www\.)?([^:\/?\n]+)/)[0],n=this.whitelistedDomains.find((function(e){return-1!==s.indexOf(e)}));void 0===n&&(e.preventDefault(),this.checkLink=e.target.href)}}},{key:"onScroll",value:function(){var e=this.$refs.chat,t=e.scrollTop,s=e.scrollHeight-e.clientHeight;t-this.lastScroll<-1?this.hasScrolled=!0:t>=s&&(this.hasScrolled=!1),this.lastScroll=t}},{key:"beforeUpdate",value:function(){var e=this,t=this.$refs.chat;t.scrollTop,t.scrollHeight,t.clientHeight;this.hasScrolled||setTimeout((function(){e.scrollToLastChild()}),10)}},{key:"mounted",value:function(){this.scrollToLastChild()}},{key:"send",value:function(){this.sendMessage(this.newMessage),this.newMessage=""}},{key:"navigateToLink",value:function(){overwolf.utils.openUrlInDefaultBrowser(this.checkLink),this.checkLink=null}},{key:"openServer",value:function(){overwolf.utils.openUrlInDefaultBrowser("ftb://server/".concat(this.friend.currentServer))}},{key:"sortedMessages",get:function(){return this.messages?this.messages.sort((function(e,t){return e.date-t.date})):[]}}]),s}(f["c"]);Object(d["a"])([Object(f["b"])()],D.prototype,"friend",void 0),Object(d["a"])([Object(f["b"])()],D.prototype,"shortHash",void 0),Object(d["a"])([Object(f["b"])()],D.prototype,"removeFriend",void 0),Object(d["a"])([Object(f["b"])()],D.prototype,"blockFriend",void 0),Object(d["a"])([Object(f["b"])()],D.prototype,"messages",void 0),Object(d["a"])([Object(f["b"])()],D.prototype,"sendMessage",void 0),D=Object(d["a"])([Object(f["a"])({components:{"ftb-input":j["a"],"ftb-button":h["a"],ConfirmationModal:H,FTBModal:U["a"]},props:["friend","shortHash","messages","sendMessage","removeFriend","blockFriend"]})],D);var $=D,z=$,B=(s("99e4"),Object(k["a"])(z,R,I,!1,null,null,null)),J=B.exports,V=function(e){Object(c["a"])(s,e);var t=Object(l["a"])(s);function s(){var e;return Object(a["a"])(this,s),e=t.apply(this,arguments),e.hasLoaded=!1,e.loadingFriends=!1,e.currentPage="",e.friend=null,e.messages={},e.friends={friends:[],requests:[]},e}return Object(o["a"])(s,[{key:"onAuthChange",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,s){var n,i,r,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("Auth changes",null===(n=t.token)||void 0===n?void 0:n.accounts,this.hasLoaded,void 0!==(null===(i=t.token)||void 0===i?void 0:i.accounts.find((function(e){return"mcauth"===e.identityProvider})))&&!this.hasLoaded),void 0===(null===(r=t.token)||void 0===r?void 0:r.accounts.find((function(e){return"mcauth"===e.identityProvider})))||this.hasLoaded||(this.hasLoaded=!0,t.token&&this.getFriends(t.token.mc.hash.long),setInterval((function(){t.token&&a.getFriends(t.token.mc.hash.long)}),3e4));case 2:case"end":return e.stop()}}),e,this)})));function t(t,s){return e.apply(this,arguments)}return t}()},{key:"getFriends",value:function(e){var t,s=this;(console.log("Loading friends"),this.loadingFriends=!0,void 0===e)&&(e=null===(t=this.auth.token)||void 0===t?void 0:t.mc.hash.long);Array.isArray(e)&&(e=e[0]),this.sendIRCMessage({payload:{type:"getFriends",hash:e},callback:function(e){console.log("Got friends"),e=e.friends,f["c"].set(s.friends,"friends",e.friends);var t=s.friends.requests;t=e.requests.map((function(e){var t=s.friends.requests.find((function(t){return t.profile.hash===e.profile.hash}));return void 0!==t&&(e.profile.friendCode=t.profile.friendCode,e.profile.display=t.profile.display),e})),f["c"].set(s.friends,"requests",t),s.loadingFriends=!1}})}},{key:"openProfile",value:function(){overwolf.utils.openUrlInDefaultBrowser("https://minetogether.io/profile/connections")}},{key:"expand",value:function(){overwolf.windows.getCurrentWindow((function(e){e&&"success"===e.status&&e.window&&e.window.id&&overwolf.windows.changeSize(e.window.id,800,e.window.height)}))}},{key:"retract",value:function(){overwolf.windows.getCurrentWindow((function(e){e&&"success"===e.status&&e.window&&e.window.id&&overwolf.windows.changeSize(e.window.id,300,e.window.height)}))}},{key:"showPage",value:function(e,t){var s=this;if(this.currentPage===e&&this.friend&&t&&this.friend.hash===t.hash)this.hidePage();else{if(this.expand(),t){if(this.friend=t,this.messages[t.profile.chat.hash.medium]){var n=this.messages[t.profile.chat.hash.medium];n=n.map((function(e){return e.read=!0,e})),f["c"].set(this.messages,this.friend.profile.chat.hash.medium,n)}this.$forceUpdate()}setTimeout((function(){s.currentPage=e}),100)}}},{key:"hidePage",value:function(){this.retract(),this.friend=null,this.currentPage=""}},{key:"blockFriend",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!==this.friend&&void 0!==this.friend.hash){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.removeFriendAction(this.friend.hash);case 4:t=e.sent,"string"===typeof t||t&&(this.sendIRCMessage({payload:{type:"blockFriend",hash:this.friend.hash}}),this.hidePage(),this.auth.token&&this.getFriends(this.auth.token.mc.hash.long));case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"removeFriend",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!==this.friend&&void 0!==this.friend.hash){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.removeFriendAction(this.friend.hash);case 4:t=e.sent,"string"===typeof t||t&&(this.hidePage(),this.auth.token&&this.getFriends(this.auth.token.mc.hash.long));case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"sendMessage",value:function(e){var t;e.length<1||null!==this.friend&&null!==this.auth.token&&(this.sendIRCMessage({payload:{type:"ircSendMessage",nick:this.friend.profile.chat.hash.medium,message:e}}),t=void 0===this.messages[this.friend.profile.chat.hash.medium]?[]:this.messages[this.friend.profile.chat.hash.medium],t.push({content:e,date:(new Date).getTime(),author:this.auth.token.mc.chat.hash.short,read:!0}),f["c"].set(this.messages,this.friend.profile.chat.hash.medium,t))}},{key:"mounted",value:function(){var e=this;this.retract(),this.registerIRCCallback((function(t){if("message"===t.jsEvent){if("privmsg"===t.ircType){var s,n,i=t.nick,r=t.message;if(-1!==e.settings.settings.blockedUsers.indexOf(i))return;n=void 0===e.messages[i]?[]:e.messages[i],n.push({content:r,author:i,date:(new Date).getTime(),read:"chatFriend"===e.currentPage&&(null===(s=e.friend)||void 0===s?void 0:s.profile.chat.hash.medium)===i}),f["c"].set(e.messages,i,n)}}else if("ctcp"===t.jsEvent){t.data;if("newFriend"===t.type){var a=e.friends.requests,o=a.find((function(e){return e.profile.chat.hash.medium===t.nick}));if(void 0!==o)return;var c=t.profile;a.push({profile:c,name:c.display,accepted:!1}),f["c"].set(e.friends,"requests",a)}e.auth.token&&e.getFriends(e.auth.token.mc.hash.long)}}))}},{key:"isMinecraftLinked",get:function(){var e,t=null===(e=this.auth.token)||void 0===e?void 0:e.accounts.find((function(e){return"mcauth"===e.identityProvider}));return void 0!==t&&null!=t}}]),s}(f["c"]);Object(d["a"])([Object(g["c"])("auth")],V.prototype,"auth",void 0),Object(d["a"])([Object(g["c"])("settings")],V.prototype,"settings",void 0),Object(d["a"])([Object(g["c"])("websocket")],V.prototype,"websocket",void 0),Object(d["a"])([Object(g["a"])("sendMessage")],V.prototype,"sendIRCMessage",void 0),Object(d["a"])([Object(g["a"])("removeFriend",{namespace:"auth"})],V.prototype,"removeFriendAction",void 0),Object(d["a"])([Object(g["a"])("saveSettings",{namespace:"settings"})],V.prototype,"saveSettings",void 0),Object(d["a"])([Object(g["a"])("registerIRCCallback")],V.prototype,"registerIRCCallback",void 0),Object(d["a"])([Object(f["d"])("auth",{deep:!0})],V.prototype,"onAuthChange",null),V=Object(d["a"])([Object(f["a"])({components:{TitleBar:u["a"],"friends-list":w,AddFriend:S,FriendChat:J,"ftb-button":h["a"]}})],V);var Y=V,G=Y,W=(s("bc53"),Object(k["a"])(G,n,i,!1,null,null,null));t["default"]=W.exports},f205:function(e,t,s){"use strict";var n=s("ba22"),i=s.n(n);i.a}}]);
//# sourceMappingURL=chat.1da5d979.js.map